<?xml version="1.0"?>
<xtpl:template xmlns:xtpl="http://rubaxa.org/">
    start
    <xtpl:get name="one"/>
    <xtpl:set name="one">|one|</xtpl:set>


    <xtpl:get name="two"/>
    <xtpl:set name="two">two1|</xtpl:set>
    <xtpl:set name="two">two2|</xtpl:set>


    <xtpl:get name="three"/>
    <xtpl:set name="three">three1|</xtpl:set>
    <xtpl:set name="three" test="false">three2|</xtpl:set>


    <xtpl:get name="four"/>
    <xtpl:set name="four">
        <xtpl:get name="five"/>
    </xtpl:set>
    <xtpl:set name="five">five|</xtpl:set>

    <xtpl:set name="six">six|</xtpl:set>
    <xtpl:get name="six"/>

	<xtpl:get name="def">def|</xtpl:get>

	<xtpl:set name="seven">7</xtpl:set>
	<xtpl:set name="nine">9</xtpl:set>

	<xtpl:foreach iterate="[0,1,2]" as="val">
		<xtpl:choose>
			<xtpl:when test="val == 1"><xtpl:get name="seven"/></xtpl:when>
			<xtpl:when test="val == 2"><xtpl:get name="eight"/></xtpl:when>
			<xtpl:otherwise><xtpl:get name="nine"/></xtpl:otherwise>
		</xtpl:choose>
		<xtpl:text>|</xtpl:text>
	</xtpl:foreach>

	<xtpl:set name="eight">8</xtpl:set>

    finish
</xtpl:template>

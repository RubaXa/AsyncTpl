(function(j){function p(a,b){t[a.replace(u,"")]=b}function n(a){return t[a.replace(u,"")]}var u=/^.+\//,t={};p("fs",{readFile:function(a,b,c){jQuery.ajax({url:a,type:"get",dataType:"text",isLocal:!0,success:function(a){c(null,a)}})},readFileSync:function(a){return jQuery.ajax({url:a,type:"get",async:!1,dataType:"text",isLocal:!0}).responseText},lstatSync:function(){return{mtime:0}}});var k=n("fs"),h=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},i=function(a){if(!(this instanceof
i))return new i(a);var b=[],c=[],d,e,r=!0,v=!0,f=!1,g=this;g.done=function(a){r&&a&&(f?a(e):b.push(a));return g};g.fail=function(a){v&&a&&(f?a(e):c.push(a));return g};g.then=function(a,b){return g.done(a).fail(b)};g.reject=function(a){r=!1;f=!0;for(e=a;c.length;)c.shift()(a);return g};g.resolve=function(a){v=!1;f=!0;for(e=a;b.length;)b.shift()(a);return g};g.promise=function(){void 0===d&&(d={done:g.done,fail:g.fail,then:g.then,promise:g.promise});return d};void 0!==a&&a(g)},z={}.toString,w="".trim,
A=/^#/,x=[].slice,B=/^\s+/,C=/\s+$/,D=/[&<>"]/g,E=/&/g,F=/>/g,G=/</g,H=/"/g,I=/'/g,l="undefined"!==typeof console&&console,f={mods:{},Array:function(a){a=a||[];a.map=a.map||function(a){for(var c=[],d=0,e=this.length;d<e;d++)c.push(a(this[d]));return c};a.add=function(a,c,d){a.__order=~~d;void 0===c?this.push(a):0==c?this.unshift(a):this.splice(c,0,a);return this};a.addOrder=function(a,c){return this.add(a,void 0,c)};a.addMulti=function(a,c){a.length&&this.splice.apply(this,[c,0].concat(a));return this};
a.order=function(){this.sort(function(a,c){return a.__order-c.__order});return this};return a},$:function(a){return"string"==typeof a?document.getElementById(a.replace(A,"")):a},sizeof:function(a){var b=0;if(a&&(f.isArray(a)||"object"==typeof a))"length"in a?b=a.length:f.each(a,function(){b++});return b},isArray:function(a){return"[object Array]"==z.call(a)},uniqId:function(){return h()+h()+"-"+h()+"-"+h()+"-"+h()+"-"+h()+h()+h()},ns:function(a,b,c){var b=b.split("."),d=b.pop();f.each(b,function(b){a[b]||
(a[b]={});a=a[b]});a[d]=c},escape:function(a){"string"===typeof a&&D.test(a)&&(~a.indexOf("&")&&(a=a.replace(E,"&amp;")),~a.indexOf("<")&&(a=a.replace(G,"&lt;")),~a.indexOf(">")&&(a=a.replace(F,"&gt;")),~a.indexOf('"')&&(a=a.replace(H,"&quot;")));return a},addslashes:function(a){return a.replace(I,"\\'")},log:l&&"object"==typeof l.log?Function.prototype.call.bind(l.log,l):function(){l&&l.log.apply(l,arguments)},exception:function(a,b,c){throw{message:a,line:b,file:c};},error:function(a,b,c){b="Error: "+
a.message+" in "+(a.file||c)+" on line "+(a.line||b);a.stack&&(b+="\n"+a.stack);f.log(b);return b},keys:function(a){var b=[];Object.keys?b=Object.keys(a):f.each(a,function(a){b.push(a)});return b},each:function(a,b,c){if(a)if(a.forEach)a.forEach(b,c);else if("length"in a&&0 in a)for(var d=0,e=a.length;d<e;d++)b.call(c,a[d],d,a);else for(d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a)},cycle:function(a,b,c){for(;a<=b;a++)c(a)},trim:w?function(a){return w.call(a)}:function(a){return String(a).replace(B,
"").replace(C,"")},extend:function(a){a=a||{};f.each(arguments,function(b,c){0<c&&f.each(b,function(b,c){a[c]=b})});return a},indexOf:function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},inherit:function(a,b,c,d){if(2===arguments.length){var e=function(){};e.prototype=b.prototype;a.prototype=new e;a.prototype.self=a;a.prototype.constructor=a;f.each(b,function(b,c){a[c]=b})}else return b.prototype[c].apply(a,d)},defer:i,load:function(a,b,c,d){var e=
f.defer();b?k.readFile(a,c||"utf-8",function(a,b){e[a?"reject":"resolve"](a||b)}):e.resolve(n("fs").readFileSync(a,c||"utf-8"));return e.done(d).promise()},mtime:function(a){return k?+Date.parse(k.lstatSync(a).mtime):0},writeFile:function(a,b,c){k&&k.writeFileSync(a,b,c)},getJSON:function(a,b,c){var d=f.defer();if(k)try{d.resolve(JSON.parse(k.readFileSync(a,b)))}catch(e){d.reject()}return d.fail(function(){c(!0)}).done(function(a){c(!1,a)}).promise()},joinObj:function(a){var b=[];f.each(a,function(a,
d){a&&b.push(d)});return b.join(" ")}};i.prototype={constructor:i};i.when=function(a){var b=i(),c=[];a instanceof i?c.push.apply(c,arguments):c=a;var d=0,e=c.length,r=function(){++d==e&&b.resolve()};f.each(c,function(a){a.done(r)});e||b.resolve();return b.promise()};void 0===Function.prototype.bind&&(Function.prototype.bind=function(a){var b=x.call(arguments,1),c=this;return function(){return c.apply(a,b.concat(x.call(arguments,0)))}});"undefined"!==typeof p?p("./utils",f):module.exports=f;var m=
n("./utils"),q=function(a,b){this._data="";this._pullLen=0;this._active=true;this._stream=b;this._callback=a};q.prototype={constructor:q,uniqId:function(){return m.uniqId()},on:function(){this._active=true},off:function(){this._active=false},v:function(a){if(this._active&&a!==void 0)this._data=this._data+m.escape(a)},w:function(a){if(this._active)this._data=this._data+a},write:function(a){if(this._active)if(arguments.length>1){var b="",c=arguments,d=c.length,e=0;switch(d){case 9:b=c[8]+b;case 8:b=
c[7]+b;case 7:b=c[6]+b;case 6:b=c[5]+b;case 5:b=c[4]+b;case 4:b=c[3]+b;case 3:b=c[2]+b;case 2:this._data=this._data+(c[0]+c[1]+b);break;default:for(d=c.length;e<d;)this._data=this._data+c[e++]}}else this._data=this._data+a},cycle:function(){this._active&&m.cycle.apply(m,arguments)},each:function(){this._active&&m.each.apply(m,arguments)},block:function(a,b,c){this.w(this.getBlock(a,b,c))},blockLabel:function(a,b,c){if(this._active){c!==void 0&&this.setBlock(a,c,true);if(this._blocks===void 0){this._chunks=
[];this._blocks=[];this._attrs=[]}a=this._chunks.push(this._data,a)-1;this._blocks.push(a);b!==void 0&&(this._attrs[a]=b);this._data=""}},setBlock:function(a,b,c){if(this._block===void 0)this._block={};if(c!==true||this._block[a]===void 0)this._block[a]=b},getBlock:function(a,b,c){this._block[a]!==void 0&&(c=this._block[a]);if(c!==void 0){a=new q;a._block=this._block;c(a,b);return a.toStr()}return""},pullSync:function(a,b,c){this.pull(a,b,c)},pull:function(a,b,c){if(this._pull===void 0)this._pull=
{};if(this._pull[b]===void 0){var d=m.defer(),e=function(){this._pullLen--;setTimeout(this.end.bind(this),0)}.bind(this);this._pullLen++;this._pull[b]=d.then(e,e);try{a[b](function(a,b){d[a?"reject":"resolve"](a||b)})}catch(f){d.reject(true)}}c!==void 0&&this._pull[b].then(function(a){c(null,a)},function(a){c(a)});return this._pull[b].promise()},end:function(){if(this._stream){this._callback(this._data);this._data=""}if(this._pullLen===0){if(this._blocks!==void 0){for(var a=this._blocks,b=this._chunks,
c=this._attrs,d=b.length,e=a.length,f;e--;){f=a[e];b[f]=this.getBlock(b[f],c[f])}a=b[--d];for(e=d;e--;)a=b[e]+a;this._data=a+this._data}this._callback!==void 0&&this._callback(this._data);this._stream&&this._callback(null)}},isActive:function(){return this._pullLen!==0},toStr:function(){return this._data}};"undefined"!==typeof p?p("./Buffer",q):module.exports=q;var o=j.AsyncTpl=j.AsyncTpl||{},s=n("utils"),J=n("Buffer");j.__xtplFn=j.__xtplFn||{};o.mods=function(a){s.extend(s.mods,a)};o.require=n;o.fetch=
function(a,b){return __xtplFn[a](b||{},new J,s)};o.get=function(a){return function(b){return o.fetch(a,b)}};var y=function(a){if(a){a.xtpl=function(a,c){return o.fetch(a,c)};a.fn.xtpl=function(b,c){if(this.length&&this[0].nodeType==1)this[0].innerHTML=a.xtpl(b,c);return this}}};j.define&&define.amd?define(["jquery"],y):y(j.jQuery);j.ajs&&ajs.loaded("{AsyncTpl}AsyncTpl.core.min")})(this);

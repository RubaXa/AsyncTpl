(function(j){function o(a,b){s[a.replace(t,"")]=b}function m(a){return s[a.replace(t,"")]}var t=/^.+\//,s={};o("fs",{readFile:function(a,b,c){jQuery.ajax({url:a,type:"get",dataType:"text",isLocal:!0,success:function(a){c(null,a)}})},readFileSync:function(a){return jQuery.ajax({url:a,type:"get",async:!1,dataType:"text",isLocal:!0}).responseText},lstatSync:function(){return{mtime:0}}});var k=m("fs"),h=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},i=function(a){if(!(this instanceof
i))return new i(a);var b=[],c=[],d,e,f=!0,u=!0,h=!1,g=this;g.done=function(a){f&&a&&(h?a(e):b.push(a));return g};g.fail=function(a){u&&a&&(h?a(e):c.push(a));return g};g.then=function(a,b){return g.done(a).fail(b)};g.reject=function(a){f=!1;h=!0;for(e=a;c.length;)c.shift()(a);return g};g.resolve=function(a){u=!1;h=!0;for(e=a;b.length;)b.shift()(a);return g};g.promise=function(){void 0===d&&(d={done:g.done,fail:g.fail,then:g.then,promise:g.promise});return d};void 0!==a&&a(g)},y={}.toString,v="".trim,
z=/^#/,w=[].slice,A=/^\s+/,B=/\s+$/,C=/[&<>"]/g,D=/&/g,E=/>/g,F=/</g,G=/"/g,H=/'/g,l="undefined"!==typeof console&&console,f={mods:{},Array:function(a){a=a||[];a.map=a.map||function(a){for(var c=[],d=0,e=this.length;d<e;d++)c.push(a(this[d]));return c};a.add=function(a,c,d){a.__order=~~d;void 0===c?this.push(a):0==c?this.unshift(a):this.splice(c,0,a);return this};a.addOrder=function(a,c){return this.add(a,void 0,c)};a.addMulti=function(a,c){a.length&&this.splice.apply(this,[c,0].concat(a));return this};
a.order=function(){this.sort(function(a,c){return a.__order-c.__order});return this};return a},$:function(a){return"string"==typeof a?document.getElementById(a.replace(z,"")):a},sizeof:function(a){var b=0;if(a&&(f.isArray(a)||"object"==typeof a))"length"in a?b=a.length:f.each(a,function(){b++});return b},isArray:function(a){return"[object Array]"==y.call(a)},uniqId:function(){return h()+h()+"-"+h()+"-"+h()+"-"+h()+"-"+h()+h()+h()},ns:function(a,b,c){var b=b.split("."),d=b.pop();f.each(b,function(b){a[b]||
(a[b]={});a=a[b]});a[d]=c},escape:function(a){if("string"===typeof a)C.test(a)&&(~a.indexOf("&")&&(a=a.replace(D,"&amp;")),~a.indexOf("<")&&(a=a.replace(F,"&lt;")),~a.indexOf(">")&&(a=a.replace(E,"&gt;")),~a.indexOf('"')&&(a=a.replace(G,"&quot;")));else if("undefined"===typeof a)return"";return a},addslashes:function(a){return a.replace(H,"\\'")},log:l&&"object"==typeof l.log?Function.prototype.call.bind(l.log,l):function(){l&&l.log.apply(l,arguments)},exception:function(a,b,c){throw{message:a,line:b,
file:c};},error:function(a,b,c){b="Error: "+a.message+" in "+(a.file||c)+" on line "+(a.line||b);a.stack&&(b+="\n"+a.stack);f.log(b);return b},keys:function(a){var b=[];Object.keys?b=Object.keys(a):f.each(a,function(a){b.push(a)});return b},each:function(a,b,c){if(a)if("length"in a&&0 in a)for(var d=0,e=a.length;d<e;d++)b.call(c,a[d],d,a);else for(d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a)},cycle:function(a,b,c){for(;a<=b;a++)c(a)},trim:v?function(a){return v.call(a)}:function(a){return String(a).replace(A,
"").replace(B,"")},extend:function(a){a=a||{};f.each(arguments,function(b,c){0<c&&f.each(b,function(b,c){a[c]=b})});return a},indexOf:function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},inherit:function(a,b,c,d){if(2===arguments.length){var e=function(){};e.prototype=b.prototype;a.prototype=new e;a.prototype.self=a;a.prototype.constructor=a;f.each(b,function(b,c){a[c]=b})}else return b.prototype[c].apply(a,d)},defer:i,load:function(a,b,c,d){var e=
f.defer();b?k.readFile(a,c||"utf-8",function(a,b){e[a?"reject":"resolve"](a||b)}):e.resolve(m("fs").readFileSync(a,c||"utf-8"));return e.done(d).promise()},mtime:function(a){return k?+Date.parse(k.lstatSync(a).mtime):0},writeFile:function(a,b,c){k&&k.writeFileSync(a,b,c)},getJSON:function(a,b,c){var d=f.defer();if(k)try{d.resolve(JSON.parse(k.readFileSync(a,b)))}catch(e){d.reject()}return d.fail(function(){c(!0)}).done(function(a){c(!1,a)}).promise()},joinObj:function(a){var b=[];f.each(a,function(a,
d){a&&b.push(d)});return b.join(" ")}};i.prototype={constructor:i};i.when=function(a){var b=i(),c=[];a instanceof i?c.push.apply(c,arguments):c=a;var d=0,e=c.length,h=function(){++d==e&&b.resolve()};f.each(c,function(a){a.done(h)});e||b.resolve();return b.promise()};void 0===Function.prototype.bind&&(Function.prototype.bind=function(a){var b=w.call(arguments,1),c=this;return function(){return c.apply(a,b.concat(w.call(arguments,0)))}});"undefined"!==typeof o?o("./utils",f):module.exports=f;var p=
m("./utils"),q=function(a,b){this._data="";this._pullLen=0;this._active=true;this._stream=b;this._callback=a},I=p.escape;q.prototype={constructor:q,uniqId:function(){return p.uniqId()},on:function(){this._active=true},off:function(){this._active=false},v:function(a){if(this._active)this._data=this._data+I(a)},w:function(a){if(this._active)this._data=this._data+a},cycle:function(){this._active&&p.cycle.apply(p,arguments)},each:function(a,b){if(this._active&&a){var c=a.length,d=c;if(typeof c!=="undefined"&&
0 in a)for(;d--;)b(a[c-d-1],c-d-1);else for(d in a)a.hasOwnProperty(d)&&b(a[d],d)}},block:function(a,b,c){this.w(this.getBlock(a,b,c))},blockLabel:function(a,b,c){if(this._active){typeof c!=="undefined"&&this.setBlock(a,c,true);if(typeof this._blocks==="undefined"){this._chunks=[];this._blocks=[];this._attrs=[]}c=this._chunks.length;this._chunks[c]=this._data;this._blocks[c]=a;this._attrs[c]=b;this._data=""}},setBlock:function(a,b,c){if(this._block===void 0)this._block={};if(c!==true||this._block[a]===
void 0)this._block[a]=b},getBlock:function(a,b,c){typeof this._block[a]!=="undefined"&&(c=this._block[a]);if(typeof c!=="udnefined"){a=new q;a._block=this._block;c(a,b);return a.toStr()}return""},pullSync:function(a,b,c){this.pull(a,b,c)},pull:function(a,b,c){if(this._pull===void 0)this._pull={};if(this._pull[b]===void 0){var d=p.defer(),e=function(){this._pullLen--;setTimeout(this.end.bind(this),0)}.bind(this);this._pullLen++;this._pull[b]=d.then(e,e);try{a[b](function(a,b){d[a?"reject":"resolve"](a||
b)})}catch(f){d.reject(true)}}c!==void 0&&this._pull[b].then(function(a){c(null,a)},function(a){c(a)});return this._pull[b].promise()},end:function(){if(this._stream){this._callback(this._data);this._data=""}if(this._pullLen===0){if(typeof this._blocks!=="undefined"){for(var a=this._blocks,b=this._chunks,c=this._attrs,d=b.length-1,e=b[d]+this.getBlock(a[d],c[d]);d--;)e=b[d]+this.getBlock(a[d],c[d])+e;this._data=e+this._data}this._callback!==void 0&&this._callback(this._data);this._stream&&this._callback(null)}},
isActive:function(){return this._pullLen!==0},toStr:function(){return this._data}};"undefined"!==typeof o?o("./Buffer",q):module.exports=q;var n=j.AsyncTpl=j.AsyncTpl||{},r=m("utils"),J=m("Buffer");j.__xtplFn=j.__xtplFn||{};n.mods=function(a){r.extend(r.mods,a)};n.require=m;n.fetch=function(a,b){return __xtplFn[a](b||{},new J,r)};n.get=function(a){return function(b){return n.fetch(a,b)}};var x=function(a){if(a){a.xtpl=function(a,c){return n.fetch(a,c)};a.fn.xtpl=function(b,c){if(this.length&&this[0].nodeType==
1)this[0].innerHTML=a.xtpl(b,c);return this}}};j.define&&define.amd?define(["jquery"],x):x(j.jQuery);j.ajs&&ajs.loaded("{AsyncTpl}AsyncTpl.core.min")})(this);

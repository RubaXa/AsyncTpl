(function(w,r){function j(d,e){t[d.replace(u,"")]=e}function k(d){return t[d.replace(u,"")]}var u=/^.+\//,t={};j("fs",{readFile:function(d,e,g){jQuery.ajax({url:d,type:"get",dataType:"text",isLocal:!0,success:function(c){g(null,c)}})},readFileSync:function(d){return jQuery.ajax({url:d,type:"get",async:!1,dataType:"text",isLocal:!0}).responseText},lstatSync:function(){return{mtime:0}}});(function(d){function e(b,a,i,c){if(!(this instanceof e))return new e(b,a,i,c);if("number"===typeof b)switch(c=i,
i=a,a=b,a){case e.TEXT_NODE:b="<text>";break;case e.CDATA_NODE:b="<cdata>";break;case e.COMMENT_NODE:b="<comment>";break;case e.CUSTOM_NODE:b="<custom>"}else b=b.toLowerCase(),b.match(g)&&(this.ns=RegExp.$1,b=RegExp.$2);this.name=b;this.type=a;this.value=i;this.attributes=c||{};this.childNodes=[]}var g=/^([^:]+):(.+)/,c={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_NODE:4,COMMENT_NODE:8,CUSTOM_NODE:20,COMPILER_NODE:21,VAR_NODE:22},b={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,
input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,wbr:!0};e.prototype={constructor:e,attr:function(b,a){if(this.attributes[b])return this.attributes[b].value;d.exception('Tag "'+this.name+'", attribute "'+(a||b)+'" is missing',this.__line,this.__file)},removeAttr:function(b){delete this.attributes[b]},c:function(b,a,c,d){return this.clone(b,a,e.COMPILER_NODE,c,d)},clone:function(b,a,c,h,n){a=e(a,this.type,a.value);a.ns=b;a.type=c;a.__line=this.__line;a.__file=this.__file;a.__open=!n;a.__close=
!!n;d.each(h,function(b,c){a.attributes[c]=e(c,e.ATTRIBUTE_NODE,b)});return a},isShort:function(){return!0===b[this.name]}};for(var h in c)e[h]=e.prototype[h]=c[h];e.findClosureIdx=function(b,a,c){if(!a.__close)for(var c=c|0,e=b.length,d=0,h;c<e;c++)if(h=b[c],a.name==h.name&&(d+=h.__close?-1:1,h.__close&&1>d))return c};"undefined"!==typeof j?j("./Node",e):module.exports=e})(k("./utils"));(function(d,e){function g(a){return y[a]}function c(a){if(!(this instanceof c))return new c(a);var b=[],d=[],h,
i,f=!0,q=!0,g=!1;this.done=function(a){f&&a!==e&&(g?a(i):b.push(a));return this}.bind(this);this.fail=function(a){q&&a!==e&&(g?a(i):d.push(a));return this}.bind(this);this.then=function(a,b){return this.done(a).fail(b)}.bind(this);this.reject=function(a){f=!1;g=!0;for(i=a;d.length;)d.shift()(a);return this}.bind(this);this.resolve=function(a){q=!1;g=!0;for(i=a;b.length;)b.shift()(a);return this}.bind(this);this.promise=function(){h===e&&(h={done:this.done,fail:this.fail,then:this.then,promise:this.promise});
return h}.bind(this);a!==e&&a(this)}var b=Object.prototype.toString,h=String.prototype.trim,f=/^#/,a=[].slice,i=/^\s+/,q=/\s+$/,n=/[&<>"]/g,x=/'/g,y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},m="undefined"!==typeof console&&console,l={Array:function(a){a=a||[];a.map=a.map||function(a){for(var b=[],o=0,c=this.length;o<c;o++)b.push(a(this[o]));return b};a.add=function(a,b,o){a.__order=~~o;b===e?this.push(a):0==b?this.unshift(a):this.splice(b,0,a);return this};a.addOrder=function(a,b){return this.add(a,
e,b)};a.addMulti=function(a,b){a.length&&this.splice.apply(this,[b,0].concat(a));return this};a.order=function(){this.sort(function(a,b){return a.__order-b.__order});return this};return a},$:function(a){return"string"==typeof a?document.getElementById(a.replace(f,"")):a},sizeof:function(a){var b=0;if(a&&(l.isArray(a)||"object"==typeof a))"length"in a?b=a.length:l.each(a,function(){b++});return b},isArray:function(a){return"[object Array]"==b.call(a)},uniqId:function(){return(new Date).getTime()+""+
Math.round(1E3*Math.random())},ns:function(a,b,c){var b=b.split("."),d=b.pop();l.each(b,function(b){a[b]||(a[b]={});a=a[b]});a[d]=c},escape:function(a){return"string"===typeof a&&n.test(a)?a.replace(n,g):a},addslashes:function(a){return a.replace(x,"\\'")},log:m&&"object"==typeof m.log?Function.prototype.call.bind(m.log,m):function(){m&&m.log.apply(m,arguments)},exception:function(a,b,c){throw{message:a,line:b,file:c};},error:function(a,b,c){a="Error: "+a.message+" in "+(a.file||c)+" on line "+(a.line||
b);this.log(a);return a},keys:function(a){var b=[];Object.keys?b=Object.keys(a):l.each(a,function(a){b.push(a)});return b},each:function(a,b,c){if(a)if(a.forEach)a.forEach(b,c);else if("length"in a&&0 in a)for(var d=0,e=a.length;d<e;d++)b.call(c,a[d],d,a);else for(d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a)},cycle:function(a,b,c){for(;a<=b;a++)c(a)},trim:h?function(a){return h.call(a)}:function(a){return(""+a).replace(i,"").replace(q,"")},extend:function(a){a=a||{};this.each(arguments,function(b,
c){0<c&&this.each(b,function(b,c){a[c]=b})},this);return a},indexOf:function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},inherit:function(a,b,c,d){if(2===arguments.length){var e=function(){};e.prototype=b.prototype;a.prototype=new e;a.prototype.self=a;a.prototype.constructor=a;l.each(b,function(b,c){a[c]=b})}else return b.prototype[c].apply(a,d)},defer:c,load:function(a,b,c,e){var h=this.defer();b?d.readFile(a,c||"utf-8",function(a,b){h[a?"reject":
"resolve"](a||b)}):h.resolve(k("fs").readFileSync(a,c||"utf-8"));return h.done(e).promise()},mtime:function(a){return d?+Date.parse(d.lstatSync(a).mtime):0},writeFile:function(a,b,c){d&&d.writeFileSync(a,b,c)},getJSON:function(a,b,c){var e=l.defer();if(d)try{e.resolve(JSON.parse(d.readFileSync(a,b)))}catch(h){e.reject()}return e.fail(function(){c(!0)}).done(function(a){c(!1,a)}).promise()}};c.prototype={constructor:c};c.when=function(a){var b=c(),d=[];a instanceof c?d.push.apply(d,arguments):d=a;
var e=0,h=d.length,i=function(){++e==h&&b.resolve()};l.each(d,function(a){a.done(i)});h||b.resolve();return b.promise()};Function.prototype.bind===e&&(Function.prototype.bind=function(b){var c=a.call(arguments,1),d=this;return function(){return d.apply(b,c.concat(a.call(arguments,0)))}});"undefined"!==typeof j?j("./utils",l):module.exports=l})(k("fs"));(function(d,e){function g(c,b){this._data="";this._pullLen=0;this._active=!0;this._stream=b;this._callback=c}g.prototype={constructor:g,on:function(){this._active=
!0},off:function(){this._active=!1},v:function(c){this._active&&c!==e&&(this._data+=d.escape(c));return this},w:function(c){if(this._active)if(1<arguments.length){var b="",d=arguments.length,e=0;switch(d){case 9:b=arguments[8]+b;case 8:b=arguments[7]+b;case 7:b=arguments[6]+b;case 6:b=arguments[5]+b;case 5:b=arguments[4]+b;case 4:b=arguments[3]+b;case 3:b=arguments[2]+b;case 2:this._data+=arguments[0]+arguments[1]+b;break;default:for(d=arguments.length;e<d;)this._data+=arguments[e++]}}else this._data+=
c;return this},cycle:function(){this._active&&d.cycle.apply(d,arguments)},each:function(){this._active&&d.each.apply(d,arguments)},block:function(c,b,d){this.w(this.getBlock(c,b,d))},blockLabel:function(c,b,d){this._active&&(d!==e&&this.setBlock(c,d,!0),this._blocks===e&&(this._chunks=[],this._blocks=[],this._attrs=[]),c=this._chunks.push(this._data,c)-1,this._blocks.push(c),b!==e&&(this._attrs[c]=b),this._data="")},setBlock:function(c,b,d){this._block===e&&(this._block={});if(!0!==d||this._block[c]===
e)this._block[c]=b},getBlock:function(c,b,d){this._block[c]!==e&&(d=this._block[c]);return d!==e?(c=new g,c._block=this._block,d(c,b),c.toStr()):""},pullSync:function(c,b,d){this.pull(c,b,d)},pull:function(c,b,h){this._pull===e&&(this._pull={});if(this._pull[b]===e){var f=d.defer(),a=function(){this._pullLen--;setTimeout(this.end.bind(this),0)}.bind(this);this._pullLen++;this._pull[b]=f.then(a,a);try{c[b](function(a,b){f[a?"reject":"resolve"](a||b)})}catch(i){f.reject(!0)}}h!==e&&this._pull[b].then(function(a){h(null,
a)},function(a){h(a)});return this._pull[b].promise()},end:function(){this._stream&&(this._callback(this._data),this._data="");if(0===this._pullLen){if(this._blocks!==e){for(var c=this._blocks,b=this._chunks,d=this._attrs,f=b.length,a=c.length,i;a--;)i=c[a],b[i]=this.getBlock(b[i],d[i]);c=b[--f];for(a=f;a--;)c=b[a]+c;this._data=c+this._data}this._callback(this._data);this._stream&&this._callback(null)}},isActive:function(){return 0!==this._pullLen},toStr:function(){return this._data}};"undefined"!==
typeof j?j("./Buffer",g):module.exports=g})(k("./utils"));(function(d,e){var g={},c=/\{\*|\*\}/g;g.fn={_defaults:function(b){return this._super._defaults.call(this,d.extend(b||{},{firstLine:!1}))},_build:function(b,e){var f=[];"string"==typeof b&&(b={name:"a"});!b.__empty&&b.__close?f.push("</"+b.name+">"):(f.push("<"+b.name),d.each(e,function(a){f.push(" "+a.name+'="');for(var a=a.value.split(c),b=0,d=a.length;b<d;b++)b%2?f.push({name:"value",value:a[b],__escape:!0}):""!==a[b]&&f.push(a[b]);f.push('"')},
this),b.__openTag||f.push(b.__empty?"/>":">"));return f},_trans:function(b,c,f){var a=[],i,g=b.attributes;if(b.ns!=this._opts.ns)b.type==b.ELEMENT_NODE&&(a=this._build(b,g));else switch(b.name){case "if":i=b.__close?"":b.attr("test");break;case "choose":this.__choose=b.__open?1:0;break;case "when":i=b.__close?"}":(1==this.__choose?"":" else ")+"if("+this.safe(b.attr("test"),b)+"){";this.__choose++;break;case "otherwise":i=b.__close?"}":" else {";break;case "foreach":g={_from:"iterate",from:g.iterate||
g.from,key:g.index,item:g.as,to:g.to};break;case "value":i=this.escape(c.shift().value,b);c.shift();break;case "include":i=b.attr("src");break;case "comment":b.type=b.TEXT_NODE;b.__empty?i="":(i="<\!--"+c.shift().value+"--\>",c.shift());break;case "template":return null}i!==e&&(d.isArray(i)?a=i:b.value=i);b.attributes=g;return a.length?a:this._super._trans.call(this,b,c,f)}};"undefined"!==typeof j?j("./XML",g):module.exports=g})(k("./utils"));(function(d,e){var g=/\r/g,c=/\n/g,b=/^\/(.+)\/(\w*)$/,
h="foreach include extends block doctype",f={fn:{_defaults:function(a){a=d.extend({left:"{{",right:"}}"},a,{tags:h,ns:e,escape:!1});a.c_open=a.left+"*";a.c_close="*"+a.right;return this._super._defaults.call(this,a)},_trans:function(a,b,c){var h=[],g,f=a.attributes;if(a.type==a.ELEMENT_NODE||a.type==a.CUSTOM_NODE)switch(a.name){case "if":case "else":case "elseif":g=f;break;case "for":case "cycle":case "script":break;case "foreach":a.__break=!0;this.__foreach||(this.__foreach=[],this.__foreachelse=
[]);if(a.__open)this.__foreach.push(f.from.value);else if(this.__foreachelse.length)return this.__foreachelse=[],a.value="}",a;break;case "foreachelse":f=this.__foreach.pop();this.__foreachelse.push(f);g="}); if(!__utils.sizeof("+this.safe(f,a)+")){";break;case "block":f=!a.__close&&a.attr("name");this.__blocks||(this.__blocks={},this.___blocks=[]);f?(this.___blocks.push(f),this.__blocks[f]=1+this.__blocks[f]||0):f=this.___blocks.shift();a.name=0<this.__blocks[f]?"set":"get";break;case "extends":case "include":a.name=
"include";g=a.attr("file");break;default:if(this.fns[a.name]){var j=[];d.each(f,function(b,c,d){d=b.value;d=/$\$/.test(d)?this.safe(d,a):'"'+d+'"';j.push(c+":"+d)});a.value="__this.fns."+a.name+"({"+j.join(",")+"},ctx)";a.name="value";return a}g=this.escape(a.name+f,a);a.name="value"}g!==e&&(a.value=g);return h.length?h:this._super._trans.call(this,a,b,c)},escape:function(a,b){var c=a.split("|"),a=c[0];d.each(c.splice(1),function(b){b=b.split(":");a="__this.mods."+b[0]+"("+a+(1<b.length?","+b.splice(1).join(","):
"")+")"});return this._super.escape.call(this,a,b)},safe:function(a,b){return this._super.safe.call(this,a.replace(/\$([a-z][a-z0-9_]*)/ig,function(a,b){return"(typeof "+b+'==="undefined"?ctx.'+b+":"+b+")"}),b)}},statics:{fn:function(a){d.each(a,function(a,b){h+=" "+b;this.fns[b]=a},this);return this},modifiers:function(a){d.each(a,function(a,b){this.mods[b]=function(){return a.apply(this,arguments)}},this);return this}}};f.fn.fns=f.statics.fns={};f.fn.mods=f.statics.mods={};f.statics.fn({assign:function(a,
b){b[a["var"]]=a.value;return""}}).modifiers({upper:function(a){return a.toUpperCase()},lower:function(a){return a.toLowerCase()},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()},nl2br:function(a){return a.replace(g,"").replace(c,"<br/>")},regexp_replace:function(a,c,d){c=c.match(b);return a.replace(RegExp(c[1],c[2]),d)}});"undefined"!==typeof j?j("./Smarty",f):module.exports=f})(k("./utils"));var v=k("AsyncTpl");v.get=k;w.AsyncTpl=v;var p={},s=k("utils");AsyncTpl.fetch=
function(d,e,g,c){"string"!=typeof e&&(c=g,g=e,e=r);if(p[d]===r)if("#"==d.charAt(0)){var b=s.$(d)||{innerHTML:"[[#"+d+" \u2014 not found]]"};p[d]=new this;p[d].loadString(b.innerHTML)}else p[d]=new this(d);var h=s.defer();p[d].fetch(g,function(b){h.resolve(b===r?"":b)});e&&h.done(function(b){var a=s.$(e);if(a)a.innerHTML=b});return h.promise().done(c)};"undefined"!=typeof jQuery&&(jQuery.tpl=function(d){AsyncTpl.engine(d);jQuery.tpl=function(){return this};return this},jQuery.fn.tpl=function(d,e){jQuery.tpl("XML").fetch(d,
this[0],e);return this})})(this);

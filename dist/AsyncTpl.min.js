(function(A,t){function n(d,i){w[d.replace(x,"")]=i}function m(d){return w[d.replace(x,"")]}var x=/^.+\//,w={};n("fs",{readFile:function(d,i,l){jQuery.ajax({url:d,type:"get",dataType:"text",isLocal:!0,success:function(d){l(null,d)}})},readFileSync:function(d){return jQuery.ajax({url:d,type:"get",async:!1,dataType:"text",isLocal:!0}).responseText},lstatSync:function(){return{mtime:0}}});(function(d){function i(f,b,d,g){if(!(this instanceof i))return new i(f,b,d,g);if("number"===typeof f)switch(g=d,
d=b,b=f,b){case i.TEXT_NODE:f="<text>";break;case i.CDATA_NODE:f="<cdata>";break;case i.COMMENT_NODE:f="<comment>";break;case i.CUSTOM_NODE:f="<custom>"}else f=f.toLowerCase(),f.match(l)&&(this.ns=RegExp.$1,f=RegExp.$2);this.name=f;this.type=b;this.value=d;this.attributes=g||{};this.childNodes=[]}var l=/^([^:]+):(.+)/,g={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_NODE:4,COMMENT_NODE:8,CUSTOM_NODE:20,COMPILER_NODE:21,VAR_NODE:22},j={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,
input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,wbr:!0};i.prototype={constructor:i,attr:function(f,b){if(this.attributes[f])return this.attributes[f].value;d.exception('Tag "'+this.name+'", attribute "'+(b||f)+'" is missing',this.__line,this.__file)},removeAttr:function(d){delete this.attributes[d]},clone:function(f,b,g,j){b=i(b,this.type,b.value);b.ns=f;b.__line=this.__line;b.__file=this.__file;b.__close=!!j;d.each(g,function(a,c){b.attributes[c]=i(c,i.ATTRIBUTE_NODE,a)});return b},isShort:function(){return!0===
j[this.name]}};for(var h in g)i[h]=i.prototype[h]=g[h];i.findClosureIdx=function(d,b){if(!b.__close)for(var g=0,j=d.length,a=0,c;g<j;g++)if(c=d[g],b.name==c.name&&(a+=c.__close?-1:1,c.__close&&1>a))return g};"undefined"!==typeof n?n("./Node",i):module.exports=i})(m("./utils"));(function(d,i){function l(a){return p[a]}function g(a){if(!(this instanceof g))return new g(a);var c=[],e=[],b,d,p=!0,o=!0,f=!1;this.done=function(a){p&&a!==i&&(f?a(d):c.push(a));return this}.bind(this);this.fail=function(a){o&&
a!==i&&(f?a(d):e.push(a));return this}.bind(this);this.then=function(a,r){return this.done(a).fail(r)}.bind(this);this.reject=function(a){p=!1;f=!0;for(d=a;e.length;)e.shift()(a);return this}.bind(this);this.resolve=function(a){o=!1;f=!0;for(d=a;c.length;)c.shift()(a);return this}.bind(this);this.promise=function(){b===i&&(b={done:this.done,fail:this.fail,then:this.then,promise:this.promise});return b}.bind(this);a!==i&&a(this)}var j=Object.prototype.toString,h=String.prototype.trim,f=/^#/,b=[].slice,
k=/^\s+/,q=/\s+$/,a=/[&<>"]/g,c=/'/g,p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},e="undefined"!==typeof console&&console,o={$:function(a){return"string"==typeof a?document.getElementById(a.replace(f,"")):a},sizeof:function(a){var c=0;if(a&&(o.isArray(a)||"object"==typeof a))"length"in a?c=a.length:o.each(a,function(){c++});return c},isArray:function(a){return"[object Array]"==j.call(a)},uniqId:function(){return(new Date).getTime()+""+Math.round(1E3*Math.random())},ns:function(a,c,e){var c=
c.split("."),b=c.pop();o.each(c,function(c){a[c]||(a[c]={});a=a[c]});a[b]=e},escape:function(c){return"string"===typeof c&&a.test(c)?c.replace(a,l):c},addslashes:function(a){return a.replace(c,"\\'")},log:e&&"object"==typeof e.log?Function.prototype.call.bind(e.log,e):function(){e&&e.log.apply(e,arguments)},exception:function(a,c,e){throw{message:a,line:c,file:e};},error:function(a,c,e){a="Error: "+a.message+" in "+(a.file||e)+" on line "+(a.line||c);this.log(a);return a},keys:function(a){var c=[];
Object.keys?c=Object.keys(a):o.each(a,function(a){c.push(a)});return c},each:function(a,c,e){if(a)if(a.forEach)a.forEach(c,e);else if("length"in a&&0 in a)for(var b=0,d=a.length;b<d;b++)c.call(e,a[b],b,a);else for(b in a)a.hasOwnProperty(b)&&c.call(e,a[b],b,a)},cycle:function(a,c,e){for(;a<=c;a++)e(a)},trim:h?function(a){return h.call(a)}:function(a){return(""+a).replace(k,"").replace(q,"")},extend:function(a){a=a||{};this.each(arguments,function(c,e){0<e&&this.each(c,function(c,e){a[e]=c})},this);
return a},indexOf:function(a,c){if(a.indexOf)return a.indexOf(c);for(var e=0,b=a.length;e<b;e++)if(a[e]===c)return e;return-1},inherit:function(a,c,e,b){if(2===arguments.length){var d=function(){};d.prototype=c.prototype;a.prototype=new d;a.prototype.self=a;a.prototype.constructor=a;o.each(c,function(c,e){a[e]=c})}else return c.prototype[e].apply(a,b)},defer:g,load:function(a,c,e,b){var p=this.defer();c?d.readFile(a,e||"utf-8",function(a,c){p[a?"reject":"resolve"](a||c)}):p.resolve(m("fs").readFileSync(a,
e||"utf-8"));return p.done(b).promise()},mtime:function(a){return d?+Date.parse(d.lstatSync(a).mtime):0},writeFile:function(a,c,e){d&&d.writeFileSync(a,c,e)},getJSON:function(a,c,e){var b=o.defer();if(d)try{b.resolve(JSON.parse(d.readFileSync(a,c)))}catch(p){b.reject()}return b.fail(function(){e(!0)}).done(function(a){e(!1,a)}).promise()}};g.prototype={constructor:g};g.when=function(a){var c=g(),e=[];a instanceof g?e.push.apply(e,arguments):e=a;var b=0,d=e.length,p=function(){++b==d&&c.resolve()};
o.each(e,function(a){a.done(p)});d||c.resolve();return c.promise()};Function.prototype.bind===i&&(Function.prototype.bind=function(a){var c=b.call(arguments,1),e=this;return function(){return e.apply(a,c.concat(b.call(arguments,0)))}});"undefined"!==typeof n?n("./utils",o):module.exports=o})(m("fs"));(function(d,i,l){function g(a,c){this._file=c;this._opts=i.extend({tags:!1,left:"<",right:">",c_open:"<\!--",c_close:"--\>",trim:!0,firstLine:!0},a);this._opts.tags&&(this._opts.tags=" "+this._opts.tags+
" ")}function j(a,c,p){var e,o;for(e="";o=a.peek();)if(q.test(o))e+=o,a.next();else break;var g=o=!1,j={},h="",i;if(!a.length())return d(d.TEXT_NODE,e);a.save("attrs");var k=!c||-1<c.indexOf(" "+e+" ");a:for(;c=a.peek();)if(k&&q.test(c))for(h="";c=a.peek();)if(a.match(p)||b.test(c)){j[h]=d(h,d.ATTRIBUTE_NODE);continue a}else if("="==c){if(f.test(a.peek(1)))i=a.next().getStr();else{for(i="";(c=a.next().peek())&&!b.test(c)&&!a.match(p);)i+=c;i=""==i?l:i}j[h]=d(h,d.ATTRIBUTE_NODE,i);continue a}else h+=
c,a.next();else if(a.match(p)){g=!0;o="/"==a.peek(-1);a.next(p);break}else k||(h+=c),a.next();if(!g)return a.load("attrs"),d(d.TEXT_NODE,e);a=k?d(e,d.ELEMENT_NODE,"",j):d(e,d.ELEMENT_NODE,"",h);a.__close=o;return a}function h(a){var c=(a+"").split(""),b=0,e={};this.pos=function(){for(var a=b;a--&&"\n"!=c[a];);return b-a+1};this.line=function(){for(var a=1,e=b;e--;)"\n"==c[e]&&a++;return a};this.peek=function(a){return c[b+(a||0)]};this.lex=function(a){return c.slice(b,b+a).join("")};this.match=function(a){var c=
this.lex(a.length)===a;this.lastMatch=c?a:null;this.lastMatchLength=c?a.length:0;return c};this.next=function(a){"string"===typeof a&&(a=a.length);b+=a||1;return this};this.save=function(a){e[a]=b;return this};this.load=function(a){b=e[a];return this};this.length=function(){return c.length-b};this.getStr=function(){for(var a,c="",e=this.peek(),b=1;a=this.peek();)if(this.next(),c+=a,"\\"==a)b++;else{if(e==a&&!(b%2))return c.substring(1,c.length-1);b=0}};this.substr=function(a,e){return c.slice(a,e||
b).join("")};this.extract=function(a,c){this.save("extract");c!==l&&this.next(c);for(var e="",b;b=this.peek();){if(this.match(a))return this.next(a),e;e+=b;this.next()}this.load("extract");return null}}var f=/['"]/,b=/^[\s\r\n\t]+$/,k=/^([$a-z][\da-z\s:>]|\/\w)$/i,q=/[a-z\d:-]/i;g.prototype={constructor:g,parse:function(a){var c,g="",e=[],f,r=this._opts,q=r.tags,u=r.left,m=r.right,n=r.c_open,s=r.c_close,y=u.length,z=0;!r.firstLine&&/^\s*<\?xml/.test(a)&&(a=i.trim(a.replace(/^[^>]+>\n?/,"")),z=1);
a=new h(a);a:for(;c=a.peek();){if(a.match(n))c=a.extract(s,a.lastMatchLength),null!==c&&e.push(d(d.COMMENT_NODE,c));else if(a.match("<![CDATA["))c=a.extract("]]\>",a.lastMatchLength),null!==c&&e.push(d(d.CDATA_NODE,c));else if(a.match(u))if(k.test(a.peek(y)+a.peek(y+1)))f="/"==a.next(u).peek()?(a.next(),!0):!1,c=j(a,q,m),r.trim&&b.test(g)?g="":""!=g&&e.push(d(d.TEXT_NODE,g)),g="",c.type!=d.TEXT_NODE&&(c.__open=!f,c.__close=c.__close||f,c.__empty=c.__open&&c.__close),e.push(c);else{g+=c;a.next();continue a}else g+=
c,a.next();0==a.length()&&""!=g&&e.push(c=d(d.TEXT_NODE,g));e.length&&(c=e[e.length-1],c.__line||(c.__line=a.line()+z,c.__file=this._file))}e.add=function(a,c){c===l?this.push(a):c==0?this.unshift(a):this.splice(c,0,a);return this};return e},build:function(a){for(var c=[],b,e,g=this.left,f=this.right;e=a.shift();){switch(e.type){case d.TEXT_NODE:case d.CDATA_NODE:b=e.value;break;case d.ELEMENT_NODE:b=g+(!e.__empty&&e.__close?"/":"")+e.name;i.each(e.attributes,function(a){b+=" "+a.name+(a.value!==
l?'="'+a.value+'"':"")});b+=(e.__empty?" /":"")+f;break;case d.CUSTOM_NODE:b=g+(e.__close?"/":"")+e.name+e.value+f}""!=b&&(c.push(b),b="")}return c.join("")},rebuild:function(a){return this.build(this.parse(a))}};"undefined"!==typeof n?n("./Parser",g):module.exports=g})(m("./Node"),m("./utils"));(function(d){function i(d){this._opts=d||{useWith:!1}}i.prototype={constructor:i,compile:function(i){function g(){var b="",g=0,a=h.length,c,f;if(a){for(;g<a;g++){f=typeof h[g];if(c!=f||"string"!=f)c&&(b+=
"string"==c?"',":","),b+="string"==f?"'":"";b+="string"==f?d.addslashes(h[g]):h[g][0];c=f}"string"==f&&(b+="'");j.push("__buf.w("+b.replace(/\r/g,"").replace(/\n/g,"\\n")+");");h=[]}}for(var j=["","",""],h=[],f,b=["undef","undefined"];f=i.shift();)f.type&&f.type==f.VAR_NODE?~d.indexOf(b,f.name)||b.push(f.name):f.__break?(g(),j.push(f.value)):"value"==f.name?f.__escape?(g(),j.push(" try{__buf.v("+f.value+")}catch(e){} ")):h.push([f.value]):"string"==typeof f||f.type==f.TEXT_NODE||f.type==f.CDATA_NODE?
h.push(f.value||f):(g(),j.push(f.value));g();this._opts.useWith?(j[0]="with( ctx ){ ",j.push(" } ")):j[0]="'use strict';/*global __buf, __this, utils, ctx*/";j[1]="var "+b.join(",");j[2]=";if(ctx.__part!==undef)__buf.off();";j=j.join("")+" __buf.end();";m("fs").writeFileSync("out.js",j);return new Function("ctx, __buf, __utils, __this",j)}};"undefined"!==typeof n?n("./Compiler",i):module.exports=i})(m("./utils"));(function(d,i){function l(g,d){this._data="";this._pullLen=0;this._active=!0;this._stream=
d;this._callback=g}l.prototype={constructor:l,on:function(){this._active=!0},off:function(){this._active=!1},v:function(g){this._active&&g!==i&&(this._data+=d.escape(g));return this},w:function(g){if(this._active)if(1<arguments.length){var d="",h=arguments.length,f=0;switch(h){case 9:d=arguments[8]+d;case 8:d=arguments[7]+d;case 7:d=arguments[6]+d;case 6:d=arguments[5]+d;case 5:d=arguments[4]+d;case 4:d=arguments[3]+d;case 3:d=arguments[2]+d;case 2:this._data+=arguments[0]+arguments[1]+d;break;default:for(h=
arguments.length;f<h;)this._data+=arguments[f++]}}else this._data+=g;return this},cycle:function(){this._active&&d.cycle.apply(d,arguments)},each:function(){this._active&&d.each.apply(d,arguments)},block:function(d,i,h){this.w(this.getBlock(d,i,h))},blockLabel:function(d,j,h){this._active&&(h!==i&&this.setBlock(d,h,!0),this._blocks===i&&(this._chunks=[],this._blocks=[],this._attrs=[]),d=this._chunks.push(this._data,d)-1,this._blocks.push(d),j!==i&&(this._attrs[d]=j),this._data="")},setBlock:function(d,
j,h){this._block===i&&(this._block={});if(!0!==h||this._block[d]===i)this._block[d]=j},getBlock:function(d,j,h){this._block[d]!==i&&(h=this._block[d]);return h!==i?(d=new l,d._block=this._block,h(d,j),d.toStr()):""},pullSync:function(d,i,h){this.pull(d,i,h)},pull:function(g,j,h){this._pull===i&&(this._pull={});if(this._pull[j]===i){var f=d.defer(),b=function(){this._pullLen--;setTimeout(this.end.bind(this),0)}.bind(this);this._pullLen++;this._pull[j]=f.then(b,b);try{g[j](function(b,a){f[b?"reject":
"resolve"](b||a)})}catch(k){f.reject(!0)}}h!==i&&this._pull[j].then(function(b){h(null,b)},function(b){h(b)});return this._pull[j].promise()},end:function(){this._stream&&(this._callback(this._data),this._data="");if(0===this._pullLen){if(this._blocks!==i){for(var d=this._blocks,j=this._chunks,h=this._attrs,f=j.length,b=d.length,k;b--;)k=d[b],j[k]=this.getBlock(j[k],h[k]);d=j[--f];for(b=f;b--;)d=j[b]+d;this._data=d+this._data}this._callback(this._data);this._stream&&this._callback(null)}},isActive:function(){return 0!==
this._pullLen},toStr:function(){return this._data}};"undefined"!==typeof n?n("./Buffer",l):module.exports=l})(m("./utils"));(function(d,i,l,g,j,h){function f(a,c){this.__lego(a,c)}var b={},k={},q={def:"<!DOCTYPE html>",strict:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">',loose:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">',xstrict:'<!DOCTYPE html PUBLIC  "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">',
transitional:'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">',xhtml:'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">'};f.fn=f.prototype={self:f,constructor:f,__lego:function(a,c){"string"!=typeof a&&(c=a,a=h);this._opts=this._defaults(c||{});this._data={};this._files={};this._listeners={};this._string=h;this._filename=a},_defaults:function(a){return d.extend({ns:this.self.NS,
left:this.self.LEFT,right:this.self.RIGHT,trim:this.self.TRIM,c_open:this.self.C_OPEN,c_close:this.self.C_CLOSE,rootDir:this.self.ROOT_DIR,compileDir:this.self.COMPILE_DIR,async:this.self.ASYNC,stream:this.self.STREAM,escape:this.self.ESCAPE,safeMode:this.self.SAFE_MODE,encoding:this.self.ENCODING,blockMode:this.self.BLOCK_MODE,debug:this.self.DEBUG},a)},_uniqKey:function(a){var c=this._opts;return c.left+c.right+c.trim+c.stream+a},_compile:function(a,c){var f=a===h?Math.random():this._uniqKey(a);
if(b[f]!==h)b[f].done(function(a){this._tpl=a}.bind(this));else if(!this._tpl&&(a===h||b[f]===h)){var e=d.defer(),i={};b[f]=e.promise();this._load(a,function(c){c?(this._tpl=c,e.resolve(this._tpl)):(this._compiler||(this._compiler=new g(this._opts)),this._parse(this._opts.rootDir+a,i,function(c){this._tpl=this._compiler.compile(c);this._save(a,i);e.resolve(this._tpl)}.bind(this),i))}.bind(this))}b[f].done(c)},_parse:function(a,c,b){this._parser===h&&(this._parser=new l(this._opts,a));var e=this._opts,
f=d.defer(),g=[],i=function(b){var e=[],i,p=a.replace(/\/[\s%|\w\._-]+$/,"/"),j,b=this._parser.parse(b);try{for(;i=b.shift();){this._prepare(i,b,g);i.prev=this.__node;j=this._trans(i,b,g);this.__node=i;j!==null&&i.type!=i.COMMENT_NODE&&g.push(j);i.name=="include"&&e.push(this._parse(p+i.value,c).done(function(a,c){g[a-1]=c}.bind(this,g.length)))}}catch(k){e=[];g=[d.error(k)]}this.__node=h;d.defer.when(e).done(function(){f.resolve(this._normalizeStack(g))}.bind(this))}.bind(this);this._string!==h?
i(this._string||"[[undefined]]"):(c[a]||(c[a]=d.mtime(a)),this.self.load(a,e.async,e.encoding,i));return f.done(b).promise()},_normalizeStack:function(a){for(var c=[],b;b=a.shift();)"string"!=typeof b&&b[0]?a=b.concat(a):c.push(b);return c},_save:function(a,c){this._opts.compileDir&&d.writeFile(this._opts.compileDir+a+".json",JSON.stringify({includes:c,template:this._tpl.toString()}),this._opts.encoding)},_load:function(a,c){var b=this._opts,e=!0,f=d.defer();b.compileDir?d.getJSON(b.compileDir+a+
".json",b.encoding,function(a,c){a?f.resolve(!1):(d.each(c.includes,function(a,c){d.mtime(c)!=a&&(e=!1)}),f.resolve(e&&(new Function("return "+c.template))()))}):f.resolve(!1);return f.done(c).promise()},_try:function(a,c,b){c||(a&&a.__line?(c=a,a=a.value):c={});return"try{"+a+"}catch(_){"+(this._opts.debug&&c.__line?"__utils.error(_,"+c.__line+',"'+c.__file+'");':"")+(b!==h?"return "+b:"")+"}"},_prepare:function(a,c){var b=c[0],e=b&&b.name;if(b){if("attrs"==e||"attributes"==e)a.__openTag=!0;d.each(b.attributes,
function(a){a.ns==this._opts.ns&&this._attr(b,a,c)},this)}},_attr:function(){},_trans:function(a,c){var b=[],e,f=a.attributes;if(this._opts.ns==a.ns||!a.ns)switch(a.name){case "script":e=" "+this._try(c.shift().value,a)+" ";c.shift();break;case "if":e=a.__close?"}":"if("+this.safe(a.value,a)+"){";break;case "else":e="}"+a.name+"{";break;case "elseif":case "else if":e="}else if("+this.safe(a.value,a)+"){";break;case "for":case "cycle":case "foreach":a.__break=!0;a.__close?a.value="});":(e="",f.to?
e="__buf.cycle("+a.attr("from")+", "+a.attr("to")+", function ("+(f.key||f.item||{value:""}).value+"){":(f.item&&(e=f.item.value),f.key&&(e+=(""==e?"__v,":",")+f.key.value),e="__buf.each("+this.safe(a.attr("from",f._from),a)+", function ("+e+"){"));break;case "pull":if(a.__close)e="__buf.w('</span>');";else{var g={id:d.uniqId(),name:a.attr("name"),as:f.as&&a.attr("value")||a.attr("name"),async:!!f.async,error:f.error&&a.attr("error")||"err"};this._pullStack||(this._pullStack=[]);this._pullStack.push(g);
e="__buf.w('<span id=\""+g.id+"\">');";f.async?e+='__buf.pull(ctx,"'+g.name+'");':(e+='__buf.pullSync(ctx,"'+g.name+'",function('+g.error+","+g.as+"){",c.push({value:"});",type:a.ELEMENT_NODE}))}break;case "assign":e=a.attr("name").split(".");g=e.shift();"ctx"==g?e='__utils.ns(ctx,"'+e.join(".")+'",':(c.push(i(g,i.VAR_NODE)),e=0<e.length?"if("+g+"===undef)"+g+"={};"+("__utils.ns("+g+',"'+e.join(".")+'",'):g+"=(");e=f.type&&"string"!=f.type?e+a.attr("value"):e+("'"+d.addslashes(a.attr("value"))+"'");
e+=");";break;case "get":var g=[],j,k;if(f.attrs)k=f.attrs.value;else for(j in f)"name"!=j&&"attrs-name"!=j&&g.push(this._try("a."+j+"="+a.attr(j),a));a.__empty?e='__buf.#method#("'+a.attr("name")+'",#attrs#);':a.__close?e="});":1==this._opts.blockMode?e='__buf.#method#("'+a.attr("name")+'",#attrs#,function (__buf,'+(f["attrs-name"]&&f["attrs-name"].value||"attrs")+"){":(e='__buf.#method#("'+a.attr("name")+'",#attrs#)',k=c.shift().value,c.shift());k?(g.length&&console.log("WARNING: Can't use block attributes at block mode == 2"),
g=this.safe(k,a)):g=g.length?"(function(a){"+g.join("")+" return a})({})":"undef";e=e.replace("#attrs#",g).replace("#method#",this._opts.stream||this.blockLevel?"block":"blockLabel");break;case "set":if("set"==c[0].name&&c[0].__close)return c.shift(),null;this.blockLevel=(this.blockLevel|0)+(a.__close?-1:1);a.__close?e="});":(e="",f.test&&(e+="if("+this.safe(a.attr("test"),a)+")"),e+='__buf.setBlock("'+a.attr("name")+'",function(__buf,'+(f["attrs-name"]&&a.attr("attrs-name")||"attrs")+"){");break;
case "fail":case "loading":case "success":g=this._pullStack[this._pullStack.length-1];if("loading"==a.name)return null;e=a.__close?"}":"if("+("fail"==a.name?"":"!")+g.error+"){";g.async&&(e=a.__close?e+('__buf.w(\'</span><script>(function(a,b){try{a.parentNode.insertBefore(b,a);b.style.display="";a.parentNode.removeChild(a);}catch(er){}})(__utils.$("#%id"),__utils.$("#%name%id"));<\/script>'.replace(/%id/g,g.id).replace("%name",a.name)+"'); });"):'__buf.pull(ctx,"'+g.name+'",function('+g.error+","+
g.as+"){__buf.w('<span id=\""+a.name+g.id+'" style="display: none">\');'+e);break;case "part":a.__close?e='if(ctx.__part=="'+this.__parts.pop()+'")__buf.off();':(e='if(ctx.__part=="'+a.attr("name")+'")__buf.on();',this.__parts||(this.__parts=[]),this.__parts.push(a.attr("name")));break;case "space":a.type=a.TEXT_NODE;e=" ";break;case "text":a.type=a.TEXT_NODE;f.value?e=a.attr("value"):(e=c.shift().value,c.shift());break;case "attrs":case "attributes":if(a.__close)e="",a.type=a.TEXT_NODE,c[0].__close&&
!c[0].__empty&&c[0].isShort()&&(c.shift(),e+="/"),e+=this._opts.right;else return(!a.prev||a.prev.type!=a.ELEMENT_NODE||a.prev.__close)&&d.exception("<"+this._opts.ns+":"+a.name+"/> must be the first child",a.__line,a.__file),null;break;case "attr":case "attribute":a.type=a.TEXT_NODE;e=a.__close?'"':" "+a.attr("name")+'="';break;case "closure":if(a.__close)e="})("+this.__closure.shift().join(",")+");";else{g=[];k=[];e="(function(";this.__closure=this.__closure||[];for(j in f)k.push(j),g.push(this.safe(a.attr(j),
a));e+=k.join(",")+"){";this.__closure.push(g)}break;default:e=this._myNode(a.name,a,f),e!==h&&(a.type=a.TEXT_NODE,d.isArray(e)&&(b=e,e=h))}e!==h&&(a.value=e);return b.length?b:a},_myNode:function(a,c,b){if(k[a])return k[a].call(this,c,b);if(k._)return k._.call(this,c,b)},fetch:function(a,c){c===h&&(c=a,a=h);this._tpl===h?this._compile(this._filename,this.fetch.bind(this,a,c)):this._tpl(a||{},new j(c,this._opts.stream),d,this)},loadString:function(a){this._string=d.trim(a);this._compile();return this},
on:function(a,c){this._listeners[a]=c;return this},set:function(a,c){"string"==typeof a?this._data[a]=c:this._data=a||{};return this},safe:function(a,c,b){if(!c||!c.__line)b=c,c=h;return this._opts.safeMode?"(function(){"+this._try("return "+a,c,'""')+"})"+(b?"":"()"):a},escape:function(a,c){return this._opts.escape?"__utils.escape("+this.safe(a,c)+")":this.safe(a,c)}};f._files={};f.load=function(a,c,b,e){return(this._files[a]||(this._files[a]=d.load(a,c,b))).done(e)};f.NS="xtpl";f.LEFT="<";f.RIGHT=
">";f.C_OPEN="<\!--";f.C_CLOSE="--\>";f.TRIM=!0;f.ASYNC=!0;f.STREAM=!1;f.ESCAPE=!0;f.SAFE_MODE=!0;f.ENCODING="utf-8";f.BLOCK_MODE=1;f.DEBUG=!0;f.ROOT_DIR="";f.COMPILE_DIR="";f.fetch=function(a,c,b){var e=new this(a),f=d.defer(),g="";e.fetch(c,function(a){null===a||!e._opts.stream?f.resolve(e._opts.stream?g:a):g+=a});b&&f.done(b);return f.promise()};f.fromString=function(a,c){return(new this(c)).loadString(a)};f.tags=function(a){d.each(a,function(a,b){k[b]=a});return this};f.tags({doctype:function(a,
b){return q[b.mode&&b.mode.value]||q.def}});f.engine=function(a){"string"==typeof a&&(a=m("./"+a));var b=this.fn;b._super={};d.each(a.statics,function(a,b){this[b]=a},this);d.each(a.fn,function(a,e){var d=b[e];d&&(b._super[e]=d);b[e]=a});return f};"undefined"!==typeof n?n("./AsyncTpl",f):module.exports=f})(m("./utils"),m("./Node"),m("./Parser"),m("./Compiler"),m("./Buffer"));(function(d,i){var l={fn:{_defaults:function(g){return this._super._defaults.call(this,d.extend(g||{},{firstLine:!1}))},_build:function(g,
i){var h=[];"string"==typeof g&&(g={name:"a"});if(!g.__empty&&g.__close)h.push("</"+g.name+">");else{h.push("<"+g.name);var f=RegExp(this._opts.ns+":");d.each(i,function(b){f.test(b.value)?h.push(" "+b.name+'="',{name:"value",value:b.value.replace(f,""),__escape:!0},'"'):h.push(" "+b.name+'="'+b.value+'"')},this);g.__openTag||h.push(g.__empty?"/>":">")}return h},_trans:function(g,j,h){var f=[],b,k=g.attributes;if(g.ns!=this._opts.ns)g.type==g.ELEMENT_NODE&&(f=this._build(g,k));else switch(g.name){case "if":b=
g.__close?"":g.attr("test");break;case "choose":this.__choose=g.__open?1:0;break;case "when":b=g.__close?"}":(1==this.__choose?"":" else ")+"if("+this.safe(g.attr("test"),g)+"){";this.__choose++;break;case "otherwise":b=g.__close?"}":" else {";break;case "foreach":k={_from:"iterate",from:k.iterate||k.from,key:k.index,item:k.as,to:k.to};break;case "value":b=this.escape(j.shift().value,g);j.shift();break;case "include":b=g.attr("src");break;case "comment":g.type=g.TEXT_NODE;g.__empty?b="":(b="<\!--"+
j.shift().value+"--\>",j.shift());break;case "template":return null}b!==i&&(d.isArray(b)?f=b:g.value=b);g.attributes=k;return f.length?f:this._super._trans.call(this,g,j,h)}}};"undefined"!==typeof n?n("./XML",l):module.exports=l})(m("./utils"));(function(d,i){var l=/\r/g,g=/\n/g,j=/^\/(.+)\/(\w*)$/,h="foreach include extends block doctype",f={fn:{_defaults:function(b){b=d.extend({left:"{{",right:"}}"},b,{tags:h,ns:i,escape:!1});b.c_open=b.left+"*";b.c_close="*"+b.right;return this._super._defaults.call(this,
b)},_trans:function(b,f,g){var a=[],c,h=b.attributes;if(b.type==b.ELEMENT_NODE||b.type==b.CUSTOM_NODE)switch(b.name){case "if":case "else":case "elseif":c=h;break;case "for":case "cycle":case "script":break;case "foreach":b.__break=!0;this.__foreach||(this.__foreach=[],this.__foreachelse=[]);if(b.__open)this.__foreach.push(h.from.value);else if(this.__foreachelse.length)return this.__foreachelse=[],b.value="}",b;break;case "foreachelse":h=this.__foreach.pop();this.__foreachelse.push(h);c="}); if(!__utils.sizeof("+
this.safe(h,b)+")){";break;case "block":h=!b.__close&&b.attr("name");this.__blocks||(this.__blocks={},this.___blocks=[]);h?(this.___blocks.push(h),this.__blocks[h]=1+this.__blocks[h]||0):h=this.___blocks.shift();b.name=0<this.__blocks[h]?"set":"get";break;case "extends":case "include":b.name="include";c=b.attr("file");break;default:if(this.fns[b.name]){var e=[];d.each(h,function(a,c,d){d=a.value;d=/$\$/.test(d)?this.safe(d,b):'"'+d+'"';e.push(c+":"+d)});b.value="__this.fns."+b.name+"({"+e.join(",")+
"},ctx)";b.name="value";return b}c=this.escape(b.name+h,b);b.name="value"}c!==i&&(b.value=c);return a.length?a:this._super._trans.call(this,b,f,g)},escape:function(b,f){var g=b.split("|"),b=g[0];d.each(g.splice(1),function(a){a=a.split(":");b="__this.mods."+a[0]+"("+b+(1<a.length?","+a.splice(1).join(","):"")+")"});return this._super.escape.call(this,b,f)},safe:function(b,d){return this._super.safe.call(this,b.replace(/\$([a-z][a-z0-9_]*)/ig,function(b,a){return"(typeof "+a+'==="undefined"?ctx.'+
a+":"+a+")"}),d)}},statics:{fn:function(b){d.each(b,function(b,d){h+=" "+d;this.fns[d]=b},this);return this},modifiers:function(b){d.each(b,function(b,d){this.mods[d]=function(){return b.apply(this,arguments)}},this);return this}}};f.fn.fns=f.statics.fns={};f.fn.mods=f.statics.mods={};f.statics.fn({assign:function(b,d){d[b["var"]]=b.value;return""}}).modifiers({upper:function(b){return b.toUpperCase()},lower:function(b){return b.toLowerCase()},capitalize:function(b){return b.charAt(0).toUpperCase()+
b.substr(1).toLowerCase()},nl2br:function(b){return b.replace(l,"").replace(g,"<br/>")},regexp_replace:function(b,d,f){d=d.match(j);return b.replace(RegExp(d[1],d[2]),f)}});"undefined"!==typeof n?n("./Smarty",f):module.exports=f})(m("./utils"));A.AsyncTpl=m("AsyncTpl");var s={},v=m("utils");AsyncTpl.fetch=function(d,i,l,g){"string"!=typeof i&&(g=l,l=i,i=t);if(s[d]===t)if("#"==d.charAt(0)){var j=v.$(d)||{innerHTML:"[[#"+d+" \u2014 not found]]"};s[d]=new this;s[d].loadString(j.innerHTML)}else s[d]=
new this(d);var h=v.defer();s[d].fetch(l,function(d){h.resolve(d===t?"":d)});i&&h.done(function(d){var b=v.$(i);if(b)b.innerHTML=d});return h.promise().done(g)};"undefined"!=typeof jQuery&&(jQuery.tpl=function(d){AsyncTpl.engine(d);jQuery.tpl=function(){return this};return this},jQuery.fn.tpl=function(d,i){jQuery.tpl("XML").fetch(d,this[0],i);return this})})(this);
